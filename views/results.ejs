<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Results - Don’t TestIO My Lie</title>
    <link rel="stylesheet" href="/public/styles.css" />
  </head>
  <body>
    <header>
      <h1>Results</h1>
      <nav>
        <a href="/admin">Admin</a>
        <a href="/vote">Vote</a>
      </nav>
    </header>

    <% if (!round) { %>
      <section class="card">
        <p>No active round yet.</p>
      </section>
    <% } else { %>
      <section class="card">
        <div class="candidate-block">
          <% if (round.photo_path) { %>
            <img src="<%= round.photo_path %>" alt="candidate" class="candidate" />
          <% } %>
          <div>
            <h2><%= round.candidate_name %></h2>
            <ol>
              <li><%= round.statements[0] %></li>
              <li><%= round.statements[1] %></li>
              <li><%= round.statements[2] %></li>
            </ol>
          </div>
        </div>
      </section>

      <section class="card">
        <h3>Results</h3>
        <div id="results" class="results-grid">
          <% for (let i=0;i<3;i++){ const s = results.statements[i]; %>
            <div class="row">
              <div class="caption"><%= round.statements[i] %></div>
              <div class="bar-track truth" data-idx="<%= i %>">
                <div class="bar truth" style="width:<%= s.total ? (s.truth*100/s.total) : 0 %>%"></div>
                <span class="bar-label">Truth: <span class="truth-count"><%= s.truth %></span></span>
              </div>
              <div class="bar-track lie" data-idx="<%= i %>">
                <div class="bar lie" style="width:<%= s.total ? (s.lie*100/s.total) : 0 %>%"></div>
                <span class="bar-label">Lie: <span class="lie-count"><%= s.lie %></span></span>
              </div>
            </div>
          <% } %>
        </div>
      </section>
    <% } %>

    <footer>
      <p>Don’t TestIO My Lie</p>
    </footer>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/public/client.js"></script>
  </body>
  </html>
<!-- Floating palms -->
